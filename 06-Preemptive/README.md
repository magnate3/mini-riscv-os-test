
```
sys_switch:
        reg_save a0  # a0 => struct context *old
        csrw    mscratch, a1
        mv      t6, a1
        reg_load t6  # a1 => struct context *new
        ret          # pc=ra; swtch to new task (new->ra)
```
(1) to save context so that trap_vector can know current context
csrw    mscratch, a1 

(2) to avoid iilegal instruciton exceptions, because   reg_load  a1 will  execute : ld a0, 72(\base), this will change 
the value of a1.  so   use  reg_load t6
 mv      t6, a1
 reg_load t6  # a1 => struct context *new





```
qemu-system-riscv64 -version
QEMU emulator version 6.1.0
Copyright (c) 2003-2021 Fabrice Bellard and the QEMU Project developers
```
```
qemu-system-riscv64 -M virt -kernel kernel.img -bios none -serial stdio -display none
OS start
timer init : 0
OS start loop 
OS: Activate next task 0
Task0: Created!
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
trap_handler!
Sync exceptions! ,  code = 7, epc = 8000034e
OOPS! What can I do!qemu-system-riscv64: terminating on signal 2
```
```
qemu-system-riscv64 -M virt -kernel kernel.img -bios none -serial stdio -display none
OS start
OS start loop 
OS: Activate next task 0
Task0: Created!
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
timer interruption!
timer_handler: 1
kernel start
OS: Back to OS

OS: Activate next task 1
Task1: Created!
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
timer interruption!
timer_handler: 2
kernel start
OS: Back to OS

OS: Activate next task 0
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
timer interruption!
timer_handler: 3
kernel start
OS: Back to OS

OS: Activate next task 1
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
timer interruption!
timer_handler: 4
kernel start
OS: Back to OS

OS: Activate next task 0
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
timer interruption!
timer_handler: 5
kernel start
OS: Back to OS

OS: Activate next task 1
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
timer interruption!
timer_handler: 6
kernel start
OS: Back to OS

OS: Activate next task 0
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
Task0: Running...
timer interruption!
timer_handler: 7
kernel start
OS: Back to OS

OS: Activate next task 1
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...
Task1: Running...

```
